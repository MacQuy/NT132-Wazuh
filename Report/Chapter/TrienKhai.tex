\chapter{Triển khai}

\section{Mô hình}

Mô hình triển khai Wazuh trong đồ án môn học được minh họa như sau:

\textbf{Giải thích mô hình:}
\begin{itemize}
    \item \textbf{Máy chủ (Wazuh Manager):} Cài đặt Wazuh Manager, Elasticsearch và Dashboard. Dùng để quản lý và phân tích log.
    \item \textbf{Máy bị giám sát (Agents):} Hai máy ảo Windows và Linux, có cài đặt Wazuh Agent để gửi dữ liệu log về server.
    \item Các máy ảo kết nối qua cùng mạng \textbf{VMnet (NAT)} để đảm bảo liên lạc nội bộ.
\end{itemize}

%-------------------------------------------------------

\section{Cài đặt}

\subsection{Bước 1. Chuẩn bị}
\begin{itemize}
    \item Một máy chủ (Windows, Ubuntu hoặc WSL2) có thể truy cập mạng nội bộ với các máy ảo.
    \item Cài đặt Docker (nếu muốn dùng dạng container) hoặc môi trường Ubuntu native.
\end{itemize}

\subsection{Bước 2. Cài đặt Wazuh Manager và Dashboard}

Trên Ubuntu/WSL, thực hiện:
\begin{verbatim}
curl -sO https://packages.wazuh.com/4.8/wazuh-install.sh
sudo bash wazuh-install.sh -a
\end{verbatim}

Script này tự động cài đặt:
\begin{itemize}
    \item \textbf{Wazuh Manager}
    \item \textbf{Elasticsearch} (lưu trữ log)
    \item \textbf{Wazuh Dashboard (Kibana UI)}
\end{itemize}

Sau khi hoàn tất, truy cập Dashboard tại:
\begin{verbatim}
https://<địa chỉ IP của máy chủ>:5601
\end{verbatim}

Tài khoản mặc định:
\begin{itemize}
    \item \textbf{Username:} admin
    \item \textbf{Password:} hiển thị sau khi cài đặt
\end{itemize}

\subsection{Bước 3. Cài đặt Wazuh Agent}

\textbf{Trên Windows:}
\begin{enumerate}
    \item Tải agent tại trang: 
        \url{https://documentation.wazuh.com/current/installation-guide/wazuh-agent/index.html}
    \item Trong quá trình cài đặt, nhập IP của Wazuh Manager.
    \item Sau khi cài đặt, mở file cấu hình:
\begin{verbatim}
<server>
  <address>192.168.153.1</address>
  <port>1514</port>
  <protocol>tcp</protocol>
</server>
\end{verbatim}
    \item Khởi động dịch vụ:
\begin{verbatim}
net start wazuh
\end{verbatim}
\end{enumerate}

\textbf{Trên Linux:}
\begin{verbatim}
curl -sO https://packages.wazuh.com/4.8/wazuh-agent-4.8.0.deb
sudo dpkg -i wazuh-agent-4.8.0.deb
sudo nano /var/ossec/etc/ossec.conf
sudo systemctl enable wazuh-agent
sudo systemctl start wazuh-agent
\end{verbatim}

\subsection{Bước 4. Kiểm tra kết nối}
Truy cập Wazuh Dashboard $\rightarrow$ mục \textbf{Agents}.  
Nếu agent hiển thị trạng thái \textbf{Active (màu xanh)}, nghĩa là kết nối thành công. 